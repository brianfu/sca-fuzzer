instruction_set: x86-64

contract_observation_clause: ct
contract_execution_clause:
  - noninterference

# Actor configuration: A host and a user process
# Isolate actors when possible
actors:
  - main: # victim
    - mode: "host"
    - privilege_level: "kernel"
  - actor2: # attacker
    - mode: "host"
    - privilege_level: "kernel"
    - observer: true

# Detect violations via Chi2-test with a threshold of 0.05
# At the cost of false negatives; Closer to 1, less tolerance to noise
analyser: chi2
analyser_stat_threshold: 0.2

# Executor
executor_mode: PP+P
x86_executor_enable_ssbp_patch: true
x86_executor_enable_prefetcher: true

# Misc. configuration
inputs_per_class: 2
executor_sample_sizes: # Run every test N times and compare distributions, each sample
  - 15 # Used for early priming
  - 40
  - 160
  - 320

# Fuzzer
enable_observation_filter: true
enable_fast_path_model: true
coverage_type: model_instructions

instruction_categories:
  - BASE-BINARY
  - BASE-BITBYTE
  - BASE-CMOV
  - BASE-COND_BR
  - BASE-CONVERT
  - BASE-DATAXFER
  - BASE-FLAGOP
  - BASE-LOGICAL
  - BASE-MISC
  - BASE-NOP
  - BASE-WIDENOP
  - BASE-POP
  - BASE-PUSH
  - BASE-SEMAPHORE
  - BASE-SETCC
  - LONGMODE-CONVERT
  - LONGMODE-DATAXFER
  - LONGMODE-SEMAPHORE

# Output
# color: true
logging_modes:
  - info
  - stat
  - dbg_coverage
  # - dbg_violation
  - dbg_timestamp
  # - dbg_generator
  # - dbg_priming
  # - dbg_model
  - dbg_executor_raw
  # - dbg_dump_htraces
  # - dbg_dump_ctraces
  # - dbg_dump_traces_unlimited

# Overwrite some of the configuration options to reproduce the violation
input_gen_seed: 500910
inputs_per_class: 1
